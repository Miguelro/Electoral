{
    "collab_server" : "",
    "contents" : "#En este fichero desarrollamos todos los indices electrorales\nRae <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  n <- length(votes)\n  res <- sum(abs(p_votes - p_seats))/n\n  return(res)\n}\n\nRae(c(1200, 30, 4000),c(10,6,8))\n\nRae_corregido <- function(votes, seats, correc = 0.5){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  lim <- sum(votes)*correc*10^-2\n  seats <- seats[votes>lim]\n  votes <- votes[votes>lim]\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  n <- length(votes)\n  res <- sum(abs(p_votes - p_seats))/n\n  return(res)\n}\n\nRae_corregido(c(1200, 30, 4000),c(10,6,8), correc = 1)\nRae_corregido(c(1200, 30, 4000),c(10,6,8))\n\nLoos_Hanby <-  function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  res <- sum(abs(p_votes - p_seats))/2\n  return(res)\n}\n\nLoos_Hanby(c(1200, 30, 4000),c(10,6,8))\n\nGallagher <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  res <- sqrt(0.5*sum((p_votes-p_seats)^2))\n  return(res)\n}\n\nRae(c(3947,3189,1971,466,345,82),c(184,99,44,10,1,0))\nGallagher(c(3947,3189,1971,466,345,82),c(184,99,44,10,1,0))\n\nSainte_Lague <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  seats <- seats[votes>0]\n  votes <- votes[votes>0]\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  res <- sum(((p_seats - p_votes)^2)/p_votes)\n  return(res)\n}\n\nL_max <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  res <- max(abs(p_seats - p_votes))\n  return(res)\n}\n\nCox_Shugart <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes <- (votes/sum(votes)) * 100\n  p_seats <- (seats/sum(seats)) * 100\n\n  model <- lm(p_seats ~ p_votes)\n  res <- model$coefficients[2]\n  #browser()\n  return(as.numeric(res))\n}\n\nCox_Shugart(c(3947,3189,1971,466,345,82),c(184,99,44,10,1,0))\n\n##Dimension del voto del sistemas de partidos\nfragmentacion_rae <- function(votes, seats){\n  if( length(votes) != length(seats)) stop(\"ERROR: La longitud de votos y escaños debe ser la misma\")\n  if(sum(votes<0) != 0) stop(\"ERROR: No puede haber un número de votos negativo\")\n  if(sum(seats<0) != 0) stop(\"ERROR: No puede haber un número de escaños negativo\")\n\n  p_votes2 <- (votes/sum(votes))^2\n  p_seats2 <- (seats/sum(seats))^2\n\n  res_electoral <- 1-sum(p_votes2)\n  res_parlamento <- 1-sum(p_seats2)\n\n  return(data.frame(electoral = res_electoral, parlamentaria = res_parlamento))\n}\n\nfragmentacion_rae(c(3947,3189,1971,466,345,82),c(184,99,44,10,1,0))\n",
    "created" : 1573312573658.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1264982499",
    "id" : "10639308",
    "lastKnownWriteTime" : 1573744513,
    "last_content_update" : 1573744514043,
    "path" : "C:/Master_Estad_Apli/TFM/Code/Relectoral/R/Electoral_index.R",
    "project_path" : "R/Electoral_index.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}